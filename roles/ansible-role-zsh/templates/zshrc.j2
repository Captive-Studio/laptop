# Generated by Ansible

## Operating system detection
if [[ -a /etc/os-release ]]; then source /etc/os-release; fi
if [[ NAME == "Arch Linux" ]]; then
  DISTRO=ARCH
elif [[ $(uname -s) == Darwin ]]; then
  DISTRO=DARWIN
elif [[ $(uname -o) == Cygwin ]]; then
  DISTRO=CYGWIN
fi

## Functions

-xdg-config () {
  test -f ${XDG_CONFIG_HOME:-~/.config}/user-dirs.dirs && source ${XDG_CONFIG_HOME:-~/.config}/user-dirs.dirs
}

-xdg-data-home () {
  echo ${XDG_DATA_HOME-$HOME/.local/share}
}

-antigen-library-filepath () {
	echo "$_ANTIGEN_INSTALL_DIR/antigen.zsh"
}

-antigen-install () {
  local antigen_lib=$(-antigen-library-filepath)
  if [[ ! -d $_ANTIGEN_INSTALL_DIR ]]; then
    mkdir -p $_ANTIGEN_INSTALL_DIR
  fi

  if [[ ! -f $antigen_lib ]]; then
    curl -L git.io/antigen > $_ANTIGEN_INSTALL_DIR/antigen.zsh
  fi
}

## Load xdg
-xdg-config

## Default config
_ZSH_AUTOLOAD_DIR="$HOME/.zshrc.d"
_ANTIGEN_INSTALL_DIR="$HOME/.antigen"
if ! ${XDG_SESSION_ID+"false"}; then
  _ANTIGEN_INSTALL_DIR=$(-xdg-data-home)/zsh-antigen
  export ADOTDIR=$_ANTIGEN_INSTALL_DIR/repo
fi

## Load / Clone antigen
-antigen-install
source $(-antigen-library-filepath)


## Load Base
antigen use oh-my-zsh
antigen theme pygmalion

antigen bundles <<EOF
  colorize
  colored-man-page
  command-not-found
  cp
  git
  hg
  pip
  python
  chrissicool/zsh-256color
  zsh-users/zsh-autosuggestions
  zsh-users/zsh-completions
  zsh-users/zsh-history-substring-search
  zsh-users/zsh-syntax-highlighting
EOF

## Load distro specific plugins
# Arch Linux plugins
if [[ $DISTRO == ARCH ]]; then
	antigen bundle archlinux
fi

# Mac OS X plugins
if [[ $DISTRO == DARWIN ]]; then
	antigen bundle osx
  antigen bundle brew
fi

## Load everything in .zshrc.d/
if [[ -d $_ZSH_AUTOLOAD_DIR/ ]]; then
  # for i in $_ZSH_AUTOLOAD_DIR/*.(zsh|sh);
  for i in $(find "$_ZSH_AUTOLOAD_DIR/" -iname "*.?sh");
  do
    . $i;
  done
fi

antigen apply

# Improve PATH with local/bin
if [ -d ~/.local/bin/ ]; then
	export PATH=$PATH:~/.local/bin/
fi
